/**
 @Name : jemobDate v1.0 手机移动端日期控件
 @Author: chen guojun
 @Date: 2016-4-20
 @QQ群：516754269
 @官网：http://www.jayui.com/jemobDate/ 或 https://github.com/singod/jemobDate
 */
!function(a){var g,h,b={},c=document,d=["datebox","datemask"],e=/\w+|d+|[\u4E00-\u9FA5\uF900-\uFA2D]|[\uFF00-\uFFEF]/g,f=function(a){return document.querySelectorAll(a)};b.each=function(a,b){for(var c=0,d=a.length;d>c&&b(c,a[c])!==!1;c++);},b.bind=function(a,c){return b.each(a,function(a,b){var d;return/Android|iPhone|SymbianOS|Windows Phone|iPad|iPod/.test(navigator.userAgent)?(b.addEventListener("touchmove",function(){d=!0},!1),b.addEventListener("touchend",function(a){a.preventDefault(),d||c.call(this,a),d=!1},!1),void 0):b.addEventListener("click",function(a){c.call(this,a)},!1)})},b.touch=function(a,b,c,d){a.addEventListener("touchstart",b,!1),a.addEventListener("touchmove",c,!1),a.addEventListener("touchend",d,!1)},b.stopmp=function(b){return b=b||a.event,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,this},b.attr=function(a,b,c){return"string"==typeof b&&"undefined"==typeof c?a.getAttribute(b):(a.setAttribute(b,c),this)},b.addClass=function(a,c){return b.each(a,function(a,b){b.classList.add(c)})},b.removeClass=function(a,c){return b.each(a,function(a,b){b.classList.remove(c)})},b.html=function(a,b){return"undefined"!=typeof b||void 0!==b&&1===a.nodeType?(a.innerHTML=b,this):a.innerHTML},b.text=function(a,b){if(void 0===b||1!==a.nodeType){var c=document.all?a.innerText:a.textContent;return c}return document.all?a.innerText=b:a.textContent=b,this},b.val=function(a,b){return void 0===b||1!==a.nodeType?a.value:(a.value=b,this)},b.digit=function(a){return 10>a?"0"+(0|a):a},b.parse=function(a,c,d){a=a.concat(c);var d=d,e=b.parseCheck(d,!1),f=2;return d.replace(/YYYY|MM|DD|hh|mm|ss/g,function(){var g="hh:mm:ss"==e||"hh:mm"==e?++f:a.index=0|++a.index;return b.digit(a[g])})},b.parseCheck=function(a,b){var d,c=[];return a.replace(/YYYY|MM|DD|hh|mm|ss/g,function(a){c.push(a)}),d=void 0==b?c:c.join(1==b?"-":":")},b.parseArr=function(a){var b=a.split(" ");return b[0].match(e)},b.nowDate=function(a,c){var d=new Date(0|a?function(a){return 864e5>a?+new Date+864e5*a:a}(parseInt(a)):+new Date);return b.parse([d.getFullYear(),d.getMonth()+1,d.getDate()],[d.getHours(),d.getMinutes(),d.getSeconds()],c)},b.montharr=[1,2,3,4,5,6,7,8,9,10,11,12],b.isValHtml=function(a){return/textarea|input/.test(a.tagName.toLocaleLowerCase())},g={format:"YYYY-MM-DD hh:mm:ss",minDate:"1970-01-01 00:00:00",maxDate:"2030-12-31 23:59:59"},b.initDate=function(a){var e=function(b,e){if(!f("#"+e)[0]){var h=c.createElement("div"),i=c.createElement("div");h.className=d[0],h.id=e,h.style.cssText="z-index:"+(a.zIndex||999)+";display:block;",i.className=i.id=d[1],i.style.cssText="z-index:"+(a.zIndex-5||994)+";",b.appendChild(h),b.appendChild(i)}},h=function(c){var d=b.nowDate(null,a.format||g.format);""==(b.val(c)||b.text(c))?b.isValHtml(c)?b.val(c,d):b.text(c,d):b.isValHtml(c)?b.val(c):b.text(c)},i=f(a.dateCell);a.isinitVal&&h(i[0]),e(c.body,d[0],!1),b.bind(i,function(c){b.stopmp(c),b.setHtml(a,this,"#"+d[0]),f("#"+d[0])[0].style.display="block",b.addClass(f("#"+d[0]),"dateshow"),b.addClass(f("#"+d[1]),"dateshow")}),setTimeout(function(){a.success&&a.success()},1)},b.setHtml=function(a,c,d){var s,h=new Date,i="",j=a.format||g.format,k=b.nowDate(null,j),l=a.isinitVal?b.isValHtml(c)?b.val(c):b.text(c):""==(b.val(c)||b.text(c))?k:b.isValHtml(c)?b.val(c):b.text(c),m=""!=(b.val(c)||b.text(c))?l.match(/\d+/g):[h.getFullYear(),h.getMonth()+1,h.getDate(),h.getHours(),h.getMinutes(),h.getSeconds()],n=["dateyear","datemonth","datetoday","datehours","dateminutes","dateseconds"],o=b.parseCheck(j).length,p=b.parseCheck(j,"YYYY"==j.substring(0,4)?!0:!1),q="hh:mm:ss"==p||"hh:mm"==p,r='<div class="datebtn_box"><div class="datebtn btncancel">取消</div><div class="datebtn btnclear">清空</div><div class="datebtn btnyes">确定</div></div>';for(s=q?3:0;q?o+3>s:o>s;s++)i+='<div class="datefixe"><div class="gear '+n[s]+'"></div><div class="points"></div></div>';b.html(f(d)[0],""),b.html(f(d)[0],r+'<div class="dateroll_mask"><div class="dateroll">'+i+"</div></div>"),b.getDateStr(a,c,d,p,m[0],m[1],m[2],m),b.dateTouch(a,c,d,p,b.dateClsArr,m)},b.getDateStr=function(a,c,d,e,h,i,j,k){var l,m,n,o,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,K,M,N,O;h=parseInt(h),i=parseInt(i),j=parseInt(j),l=new Date,m="",n="",o="",q=b.val(c)||b.text(c),s=b.parseArr(a.minDate||g.minDate),t=b.parseArr(a.maxDate||g.maxDate),u=f(d+" .dateyear"),v=f(d+" .datemonth"),w=f(d+" .datetoday"),x=f(d+" .datehours"),y=f(d+" .dateminutes"),z=f(d+" .dateseconds"),A=parseInt(s[0]),B=parseInt(t[0]),C=i==parseInt(s[1]),D=l.getMonth()+1,E=[h,i,j,k[3],k[4],k[5]],F=function(a,b){var c=0==a%4&&0!=a%100||0==a%400?29:28;return[31,c,31,30,31,30,31,31,30,31,30,31][b-1]},G=function(){var c,d,e,f;for(c=A;B>=c;c++)m+='<p class="tooth" data-vals='+c+">"+c+"年</p>";for(b.html(u[0],m),b.attr(u[0],"data-len",B-A+1),d=a.isLimit?h==A?l.getMonth()+1:1:1,e=a.isLimit?b.montharr.length-D+1:b.montharr.length,f=d;f<=b.montharr.length;f++)n+='<p class="tooth" data-vals='+b.digit(f)+">"+b.digit(f)+"月</p>";b.html(v[0],n),b.attr(v[0],"data-len",e)},H=function(){var e,c=F(parseInt(h),parseInt(i)),d=a.isLimit?C?parseInt(s[2]):1:1;for(dsLen=a.isLimit?C&&parseInt(t[2])>=parseInt(s[2])?parseInt(t[2])-parseInt(s[2])+1:i!=parseInt(s[1])?c:c-parseInt(s[2])+1:c,e=d;a.isLimit?dsLen+d>e:dsLen>=e;e++)o+='<p class="tooth" data-vals='+b.digit(e)+">"+b.digit(e)+"日</p>";b.html(w[0],o),b.attr(w[0],"data-len",dsLen)},I=function(a,c){var d=["时","分","秒"],e="hh:mm"==c?[24,60]:[24,60,60];b.each(e,function(c,e){var g,f="";for(g=0;e>g;g++)f+='<p class="tooth" data-vals='+b.digit(g)+">"+b.digit(g)+d[c]+"</p>";b.html(a[c][0],f),b.attr(a[c][0],"data-len",e)})},K="hh:mm"==e.substring(0,5),M=b.parseCheck(a.format||g.format).length,2==M?(N=K?[x,y]:[u,v],K?I(N,e):G()):3==M?(N=K?[x,y,z]:[u,v,w],K?I(N,e):(G(),H())):M>=5&&(O=(a.format||g.format).split(" "),N="hh:mm"==b.parseCheck(O[1],!1)?[u,v,w,x,y]:[u,v,w,x,y,z],G(),H(),I("hh:mm"==b.parseCheck(O[1],!1)?[x,y]:[x,y,z],b.parseCheck(O[1],!1))),b.dateClsArr=N,b.each(b.dateClsArr,function(c,d){var f="",g=[h-A,a.isLimit?0:i-1,a.isLimit?j-(C?k[2]:1):j-1,k[3],k[4],k[5]],l="hh:mm:ss"==e||"hh:mm"==e,m=E[""==q?l?c+3:c:""!=q?c:c+3];a.isLimit?2==M?f=l?m:0==c?h-parseInt(s[0]):h==parseInt(s[0])?i-D:i-1:3==M?f=l?m:2==c?C&&j<parseInt(s[2])?0:g[c]:0==c?h-parseInt(s[0]):h==parseInt(s[0])?i-D:i-1:M>=5&&(f=0==c?h-parseInt(s[0]):1==c?h==parseInt(s[0])?i-D:i-1:2==c?C&&j<parseInt(s[2])?0:g[c]:E[c]):f=l?m:g[c],b.attr(d[0],"data-val",m),b.attr(d[0],"data-num",f),b.attr(d[0],"data-top",-(2.5*f)),d[0].style["-webkit-transform"]="translate3d(0,"+-(2.5*f)+"em,0)"}),b.events(a,c,d,e,k)},b.dateClose=function(a){b.removeClass(f("#"+a[0]),"dateshow"),b.removeClass(f("#"+a[1]),"dateshow")},b.events=function(a,c,e,h){var j=new Date;b.bind(f(e+" .btncancel"),function(){b.dateClose(d)}),b.bind(f(e+" .btnclear"),function(){var e=b.isValHtml(c)?b.val(c):b.text(c);b.isValHtml(c)?b.val(c,""):b.text(c,""),b.dateClose(d),""!=e&&("function"==typeof a.clearfun||null!=a.clearfun)&&a.clearfun(e)}),b.bind(f(e+" .btnyes"),function(){var k,i=[];b.each(f(e+" .gear"),function(a,c){i.push(b.attr(c,"data-val"))}),k="hh:mm:ss"==h||"hh:mm"==h?b.parse([j.getFullYear(),j.getMonth()+1,j.getDate()],[i[0],i[1],i[2]],a.format||g.format):b.parse([i[0],i[1],i[2]||j.getDate()],[i[3]||j.getHours(),i[4]||j.getMinutes(),i[5]||j.getSeconds()],a.format||g.format),b.isValHtml(c)?b.val(c,k):b.text(c,k),b.dateClose(d),("function"==typeof a.yesfun||null!=a.yesfun)&&a.yesfun(k)})},b.dateTouch=function(c,d,e,g,h,i){function j(a){var c,d;for(a.preventDefault(),c=a.target;;){if(c.classList.contains("gear"))break;c=c.parentElement}clearInterval(c["int_"+c.id]),c["old_"+c.id]=a.targetTouches[0].screenY,c["o_t_"+c.id]=(new Date).getTime(),d=b.attr(c,"data-top"),c["o_d_"+c.id]=d?parseFloat(d):0,c.style.webkitTransitionDuration=c.style.transitionDuration="0ms"}function k(c){var d,e;for(c.preventDefault(),d=c.target;;){if(d.classList.contains("gear"))break;d=d.parentElement}d["new_"+d.id]=c.targetTouches[0].screenY,d["n_t_"+d.id]=(new Date).getTime(),e=9*(d["new_"+d.id]-d["old_"+d.id])/a.innerHeight,d["pos_"+d.id]=d["o_d_"+d.id]+e,d.style["-webkit-transform"]="translate3d(0,"+d["pos_"+d.id]+"em,0)",b.attr(d,"data-top",d["pos_"+d.id]),c.targetTouches[0].screenY<1&&l(c)}function l(a){var b,c;for(a.preventDefault(),b=a.target;;){if(b.classList.contains("gear"))break;b=b.parentElement}c=(b["new_"+b.id]-b["old_"+b.id])/(b["n_t_"+b.id]-b["o_t_"+b.id]),b["spd_"+b.id]=Math.abs(c)<=.25?0>c?-.08:.08:Math.abs(c)<=.5?0>c?-.16:.16:c/2.5,b["pos_"+b.id]||(b["pos_"+b.id]=0),m(b)}function m(a){function e(){a.style.webkitTransitionDuration=a.style.transitionDuration="150ms",d=!0}var c=0,d=!1;clearInterval(a["int_"+a.id]),a["int_"+a.id]=setInterval(function(){var h,i,j,f=a["pos_"+a.id],g=a["spd_"+a.id]*Math.exp(-.015*c);f+=g,Math.abs(g)>.1||(h=2.5*Math.round(f/2.5),f=h,e()),f>0&&(f=0,e()),i=2.5*-(a.dataset.len-1),i>f&&(f=i,e()),d&&(j=Math.abs(f)/2.5,n(a,j),clearInterval(a["int_"+a.id])),a["pos_"+a.id]=f,a.style["-webkit-transform"]="translate3d(0,"+f+"em,0)",b.attr(a,"data-top",f),c++},15)}function n(a,d){var h,j,k,l,m;d=Math.round(d),h=[],j=b.attr(a.childNodes[d],"data-vals"),b.attr(a,"data-num",d),b.attr(a,"data-val",j),o(a),b.each(f(e+" .gear"),function(a,c){h.push(b.attr(c,"data-val"))}),k=0==h[0].charAt(0)?h[0].replace(/0/,""):h[0],l=0==h[1].charAt(0)?h[1].replace(/0/,""):h[1],m=void 0==h[2]?(new Date).getDate():0==h[2].charAt(0)?h[2].replace(/0/,""):h[2],b.getDateStr(c,a,e,g,k,l,m,i)}function o(a){var c=b.attr(a,"data-len"),d=b.attr(a,"data-num"),e=c-1;d>e&&(d=e),b.attr(a,"data-len",c),a.style["-webkit-transform"]="translate3d(0,"+2.5*-d+"em,0)",b.attr(a,"data-top",2.5*-d+"em"),b.attr(a,"data-num",d)}b.each(h,function(a,c){b.touch(c[0],j,k,l)})},h=function(a){return new b.initDate(a||{})},h.version="1.0",h.now=function(a){function e(a){var b=new Date(1e3*a);return b.getFullYear()+"-"+d(b.getMonth()+1,2)+"-"+d(b.getDate(),2)+" "+d(b.getHours(),2)+":"+d(b.getMinutes(),2)+":"+d(b.getSeconds(),2)}var b=new Date(0|a?function(a){return 864e5>a?+new Date+864e5*a:a}(parseInt(a)):+new Date),c=new Date,d=function(a,b){var c="00"+a.toString();return c.substr(c.length-b)},f=b.getFullYear(),g=b.getMonth()+1,h=b.getDate(),i="string"==typeof a?e(a):f+"-"+d(g,2)+"-"+d(h,2)+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();return i},"function"==typeof define?define(function(){return h}):"object"==typeof module&&"object"==typeof module.exports?module.exports=h:a.jemobDate=touchDate=h}(window);